# This workflow triggers a new workflow inside the graasp-deploy repository. It passes a json 
# with the repository name and the latest tag pushed from the caller repository. 
name: Push new tag to graasp-deploy repository

# Controls when the action will run
on:
  # Allow the workflow to be manually triggered
  workflow_dispatch:
    # Inputs the workflow accepts.
    inputs:
      release-type:
        # Description to be shown in the UI instead of 'stack'
        description: 'Select a release type'
        # Default value if no value is explicitly provided
        # Input does not have to be provided for the workflow to run
        type: choice
        options: 
        - first
        - patch        
        - minor        
        - major
        default: patch
        required: true

# This workflow is made up of one job that calls the reusable workflow in graasp-deploy
jobs:
  graasp-deploy-update-staging-version-workflow:
    # Replace with repository name
    name: Graasp Builder
    # Replace 'main' with the hash of a commit, so it points to an specific version of the reusable workflow that is used
    # Reference reusable workflow file. Using the commit SHA is the safest for stability and security
    uses: graasp/graasp-deploy/.github/workflows/update-staging-version.yml@734f4d3081756941b608f4e24d926ea7eb34facc
    with:
      release-type: ${{ inputs.release-type }}
    secrets:
      token: ${{ secrets.REPO_ACCESS_TOKEN }}
